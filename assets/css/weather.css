/* Weather panel system (moved from styles.css — keep module self-contained) */

/* =========================
   WEATHER PANEL — APPLE-LIKE LIVE CARD
   Supports:
   - data-weather-theme: clear|partly|overcast|rain|storm|snow
   - data-weather-night: true|false
========================= */
[data-weather-panel]{
  position: relative;
  overflow:hidden;
  padding: 18px; /* tighter for “app” density */
  background: rgba(255,255,255,.035);
}

/* Keep existing “soft glow separation” but tuned */
[data-weather-panel]::before{
  content:"";
  position:absolute;
  inset:-1px;
  pointer-events:none;
  background:
    radial-gradient(620px 340px at 12% 10%, rgba(199,162,74,.12), transparent 55%),
    radial-gradient(520px 340px at 92% 12%, rgba(91,11,31,.14), transparent 60%);
  opacity: .45;
  mix-blend-mode: screen;
}

/* Live layer container */
[data-weather-panel] .wx-live{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index: 0;
}

/* Base “sky” */
[data-weather-panel] .wx-live-base{
  position:absolute;
  inset:-20%;
  background:
    radial-gradient(900px 620px at 20% 14%, var(--wx-a), transparent 60%),
    radial-gradient(820px 560px at 84% 18%, var(--wx-b), transparent 62%),
    radial-gradient(920px 660px at 50% 86%, var(--wx-c), transparent 60%),
    linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.55));
  filter: blur(var(--wx-blur));
  transform: translate3d(0,0,0);
  opacity: .95;
  animation: wx-drift var(--wx-motion) var(--ease) infinite alternate;
}

[data-weather-panel] .wx-live-glow{
  position:absolute;
  inset:-10%;
  background:
    radial-gradient(680px 420px at 35% 22%, rgba(255,255,255,.06), transparent 58%),
    radial-gradient(520px 360px at 70% 28%, rgba(255,255,255,.04), transparent 60%),
    radial-gradient(720px 520px at 55% 82%, rgba(255,255,255,.03), transparent 65%);
  filter: blur(calc(var(--wx-blur) - 4px));
  opacity: .55;
  animation: wx-drift2 var(--wx-motion2) var(--ease) infinite alternate;
}

/* Noise overlay (subtle, not glitter) */
[data-weather-panel] .wx-live-noise{
  position:absolute;
  inset:0;
  background:
    repeating-radial-gradient(circle at 50% 50%,
      rgba(255,255,255,.018) 0,
      rgba(255,255,255,.018) 1px,
      transparent 2px,
      transparent 5px
    );
  opacity: .14;
  mix-blend-mode: overlay;
}

@keyframes wx-drift{
  from{ transform: translate3d(-0.8%, -0.6%, 0); }
  to{ transform: translate3d(0.8%, 0.6%, 0); }
}
@keyframes wx-drift2{
  from{ transform: translate3d(0.6%, -0.4%, 0); }
  to{ transform: translate3d(-0.6%, 0.4%, 0); }
}

/* Night mode: deepen plate, reduce warm */
[data-weather-panel][data-weather-night="true"]{
  --wx-plate: rgba(8,9,12,.62);
  --wx-plate2: rgba(8,9,12,.82);
}
[data-weather-panel][data-weather-night="true"] .wx-live-base{
  opacity: .88;
}
[data-weather-panel][data-weather-night="true"] .wx-live-glow{
  opacity: .35;
}

/* Theme tones (cooler when weather is “worse”, per your rule) */
[data-weather-panel][data-weather-theme="clear"]{
  --wx-a: rgba(199,162,74,.22);
  --wx-b: rgba(91,11,31,.18);
  --wx-c: rgba(90,145,170,.14);
}
[data-weather-panel][data-weather-theme="partly"]{
  --wx-a: rgba(199,162,74,.16);
  --wx-b: rgba(91,11,31,.14);
  --wx-c: rgba(86,150,175,.18);
}
[data-weather-panel][data-weather-theme="overcast"]{
  --wx-a: rgba(70,120,145,.16);
  --wx-b: rgba(40,55,70,.18);
  --wx-c: rgba(90,145,170,.22);
}
[data-weather-panel][data-weather-theme="rain"]{
  --wx-a: rgba(54,116,150,.18);
  --wx-b: rgba(35,55,78,.22);
  --wx-c: rgba(90,145,170,.28);
}
[data-weather-panel][data-weather-theme="storm"]{
  --wx-a: rgba(44,96,135,.20);
  --wx-b: rgba(18,30,45,.30);
  --wx-c: rgba(90,145,170,.30);
}
[data-weather-panel][data-weather-theme="snow"]{
  --wx-a: rgba(185,205,220,.18);
  --wx-b: rgba(70,95,115,.18);
  --wx-c: rgba(210,225,235,.22);
}

/* Ensure weather content sits above live layers */
[data-weather-panel] .wx-head,
[data-weather-panel] .wx-hero,
[data-weather-panel] .wx-metrics,
[data-weather-panel] .wx-hourly-wrap,
[data-weather-panel] .wx-stack,
.weather-5day,
[data-weather-hint]{
  position: relative;
  z-index: 1;
}

/* Header row */
[data-weather-panel] .wx-head{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 12px;
  padding: 2px 2px 10px;
}

[data-weather-panel] .wx-date{
  font-size: 12px;
  letter-spacing: .14em;
  text-transform: uppercase;
  color: rgba(233,229,222,.80);
}
[data-weather-panel] .wx-loc{
  margin-top: 6px;
  font-size: 13px;
  color: rgba(233,229,222,.92);
  max-width: 30ch;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

[data-weather-panel] .wx-head-right{
  display:flex;
  gap: 8px;
  flex-wrap:wrap;
  justify-content:flex-end;
  align-items:center;
}

[data-weather-panel] .wx-chip{
  font-size: 12px;
  padding: 7px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.12);
  color: rgba(233,229,222,.86);
  backdrop-filter: blur(10px);
}
[data-weather-panel] .wx-chip-verified{
  border-color: rgba(199,162,74,.48);
  background: rgba(199,162,74,.12);
  color: rgba(233,229,222,.96);
}

/* Hero */
[data-weather-panel] .wx-hero{
  display:flex;
  align-items:flex-end;
  justify-content:space-between;
  gap: 12px;

  border-radius: 22px;
  border: 1px solid rgba(255,255,255,.10);
  background: linear-gradient(180deg, var(--wx-plate), var(--wx-plate2));
  backdrop-filter: blur(18px);
  padding: 14px 14px 12px;
  box-shadow: 0 14px 34px rgba(0,0,0,.28);
}

[data-weather-panel] .wx-temp-row{
  display:flex;
  align-items:flex-end;
  gap: 10px;
}

[data-weather-panel] .wx-temp{
  font-size: clamp(44px, 4.2vw, 54px);
  line-height: 1;
  color: rgba(233,229,222,.96);
  letter-spacing: -0.02em;
}

[data-weather-panel] .wx-unit{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  height: 34px;
  padding: 0 12px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(233,229,222,.92);
  cursor:pointer;
  transition: background .2s var(--ease), border-color .2s var(--ease), transform .08s var(--ease);
}
[data-weather-panel] .wx-unit:hover{ background: rgba(255,255,255,.10); }
[data-weather-panel] .wx-unit:active{ transform: translateY(1px); }

[data-weather-panel] .wx-feels{
  margin-top: 6px;
  font-size: 13px;
  color: rgba(233,229,222,.76);
}

[data-weather-panel] .wx-badges{
  display:flex;
  gap: 8px;
  flex-wrap:wrap;
  margin-top: 10px;
}
[data-weather-panel] .wx-badge{
  font-size: 12px;
  padding: 7px 10px;
  border-radius: 999px;
  border: 1px solid rgba(199,162,74,.42);
  background: rgba(199,162,74,.10);
  color: rgba(233,229,222,.94);
}
[data-weather-panel] .wx-badge-soft{
  border-color: rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(233,229,222,.86);
}

[data-weather-panel] .wx-hero-right{
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap: 8px;
  min-width: 94px;
}

/* Minimal line icon container (main.js will inject SVG) */
[data-weather-panel] .wx-icon{
  width: 44px;
  height: 44px;
  display:grid;
  place-items:center;
  opacity: .98;
  filter: drop-shadow(0 10px 16px rgba(0,0,0,.35));
}
[data-weather-panel] .wx-icon svg{
  width: 42px;
  height: 42px;
}
[data-weather-panel] .wx-icon svg *{
  stroke: rgba(233,229,222,.92);
  fill: none;
  stroke-width: 1.6;
  stroke-linecap: round;
  stroke-linejoin: round;
}

[data-weather-panel] .wx-cond{
  font-size: 13px;
  color: rgba(233,229,222,.78);
  max-width: 22ch;
  text-align:right;
}

/* Metrics grid */
[data-weather-panel] .wx-metrics{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-top: 12px;
}

[data-weather-panel] .wx-metric{
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.12);
  padding: 10px 10px;
  backdrop-filter: blur(10px);
}

[data-weather-panel] .wx-metric-ico{
  width: 22px;
  height: 22px;
  margin-bottom: 8px;
  opacity: .9;
}
[data-weather-panel] .wx-metric-val{
  font-size: 13px;
  color: rgba(233,229,222,.92);
}
[data-weather-panel] .wx-metric-lbl{
  margin-top: 4px;
  font-size: 12px;
  color: rgba(233,229,222,.66);
}

/* Minimal “line icon” metrics (pure CSS) */
[data-weather-panel] .wx-metric-ico[data-wx-ico]{
  position: relative;
}
[data-weather-panel] .wx-metric-ico[data-wx-ico]::before,
[data-weather-panel] .wx-metric-ico[data-wx-ico]::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius: 10px;
}
[data-weather-panel] .wx-metric-ico[data-wx-ico]::before{
  border: 1.6px solid rgba(233,229,222,.62);
  opacity: .35;
}
[data-weather-panel] .wx-metric-ico[data-wx-ico="sunrise"]::after{
  content:"";
  left: 4px; right: 4px; top: 10px; bottom: 10px;
  border-top: 1.6px solid rgba(233,229,222,.78);
}
[data-weather-panel] .wx-metric-ico[data-wx-ico="sunset"]::after{
  content:"";
  left: 4px; right: 4px; top: 10px; bottom: 10px;
  border-bottom: 1.6px solid rgba(233,229,222,.78);
}
[data-weather-panel] .wx-metric-ico[data-wx-ico="wind"]::after{
  content:"";
  left: 4px; right: 4px; top: 6px;
  height: 10px;
  background:
    linear-gradient(90deg, rgba(233,229,222,.70), rgba(233,229,222,.70)) 0 2px / 100% 1.6px no-repeat,
    linear-gradient(90deg, rgba(233,229,222,.55), rgba(233,229,222,.55)) 0 7px / 78% 1.6px no-repeat;
}
[data-weather-panel] .wx-metric-ico[data-wx-ico="humidity"]::after{
  content:"";
  left: 8px; right: 8px; top: 5px; bottom: 5px;
  border: 1.6px solid rgba(233,229,222,.72);
  border-radius: 999px;
  opacity: .55;
}
[data-weather-panel] .wx-metric-ico[data-wx-ico="pressure"]::after{
  content:"";
  left: 4px; right: 4px; top: 10px;
  height: 1.6px;
  background: rgba(233,229,222,.72);
  box-shadow: 0 -4px 0 rgba(233,229,222,.45), 0 4px 0 rgba(233,229,222,.45);
}
[data-weather-panel] .wx-metric-ico[data-wx-ico="precip"]::after{
  content:"";
  left: 10px; right: 10px; top: 6px; bottom: 6px;
  border-left: 1.6px solid rgba(233,229,222,.72);
  border-right: 1.6px solid rgba(233,229,222,.72);
  opacity: .45;
}

/* Hourly strip (5, centered on event start time; middle card highlighted via .is-center) */
[data-weather-panel] .wx-hourly-wrap{ margin-top: 12px; }

[data-weather-panel] .wx-hour{
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.12);
  padding: 10px 10px 10px;
  color: rgba(233,229,222,.92);
  cursor:pointer;
  text-align:left;
  backdrop-filter: blur(10px);
  transition: transform .08s var(--ease), background .2s var(--ease), border-color .2s var(--ease), box-shadow .2s var(--ease);
}
[data-weather-panel] .wx-hour:hover{
  background: rgba(255,255,255,.07);
  box-shadow: 0 12px 26px rgba(0,0,0,.22);
}
[data-weather-panel] .wx-hour:active{ transform: translateY(1px); }

/* Center emphasis (main.js applies .is-center to the middle card) */
[data-weather-panel] .wx-hour.is-center{
  border-color: rgba(199,162,74,.36);
  background: rgba(199,162,74,.10);
}

[data-weather-panel] .wx-hour-time{
  font-size: 12px;
  letter-spacing: .12em;
  text-transform: uppercase;
  color: rgba(233,229,222,.74);
}
[data-weather-panel] .wx-hour-ico{
  width: 22px;
  height: 22px;
  margin: 10px 0 8px;
}
[data-weather-panel] .wx-hour-ico svg{
  width: 22px;
  height: 22px;
}
[data-weather-panel] .wx-hour-ico svg *{
  stroke: rgba(233,229,222,.88);
  fill: none;
  stroke-width: 1.6;
  stroke-linecap: round;
  stroke-linejoin: round;
}
[data-weather-panel] .wx-hour-temp{
  font-size: 14px;
  color: rgba(233,229,222,.94);
}
[data-weather-panel] .wx-hour-wind{
  margin-top: 6px;
  font-size: 12px;
  color: rgba(233,229,222,.66);
}

/* Sparkline */
[data-weather-panel] .wx-spark{
  width: 100%;
  height: 26px;
  margin-top: 10px;
  opacity: .65;
}
[data-weather-panel] .wx-spark path{
  fill: none;
  stroke: rgba(233,229,222,.62);
  stroke-width: 1.6;
  stroke-linecap: round;
}

/* Stacked summary (multi-event): one mini-card per event */
[data-weather-panel] .wx-stack{
  margin-top: 12px;
  display:flex;
  flex-direction:column;
  gap: 10px;
}

[data-weather-panel] .wx-event{
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.12);
  padding: 12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;
  backdrop-filter: blur(10px);
}

[data-weather-panel] .wx-event-left{
  min-width: 0;
}
[data-weather-panel] .wx-event-title{
  font-size: 13px;
  color: rgba(233,229,222,.94);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
[data-weather-panel] .wx-event-sub{
  margin-top: 6px;
  font-size: 12px;
  color: rgba(233,229,222,.66);
}

[data-weather-panel] .wx-event-right{
  display:flex;
  align-items:center;
  gap: 10px;
  flex: 0 0 auto;
}
[data-weather-panel] .wx-event-hi{
  font-size: 14px;
  color: rgba(233,229,222,.94);
}
[data-weather-panel] .wx-event-prob{
  font-size: 12px;
  padding: 6px 9px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.05);
  color: rgba(233,229,222,.78);
}

/* =========================
   WEATHER — small-screen adjustments for live module
========================= */
@media (max-width: 980px){
  /* Hourly: allow scroll when narrow (scoped) */
  [data-weather-panel] .wx-hourly{
    grid-template-columns: repeat(5, minmax(120px, 1fr));
    overflow-x:auto;
    padding-bottom: 6px;
    scroll-snap-type: x mandatory;
  }
  [data-weather-panel] .wx-hourly > *{ scroll-snap-align: start; }
  [data-weather-panel] .wx-hourly::-webkit-scrollbar{ height: 0; }
  [data-weather-panel] .wx-hourly{ scrollbar-width: none; }

  [data-weather-panel] .wx-metrics{ grid-template-columns: repeat(2, 1fr); }
}
